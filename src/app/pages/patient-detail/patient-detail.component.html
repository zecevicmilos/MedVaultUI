<div class="card" *ngIf="info">
    <h3>{{info.firstName}} {{info.lastName}} <small class="badge">Broj medicinskog kartona: {{info.medicalRecordNumber}}</small></h3>
    <small class="muted">Kreirano: {{info.createdAt | date:'short'}}</small>


    <div class="tabs mt">
        <div class="tab" [class.active]="tab==='ov'" (click)="tab='ov'">Pregled</div>
        <div class="tab" [class.active]="tab==='sc'" (click)="tab='sc'">Skenirani dokumenti</div>
        <div class="tab" [class.active]="tab==='id'" (click)="tab='id'">Lični dokumenti</div>
        <div class="tab" [class.active]="tab==='en'" (click)="tab='en'">Posete</div>
        <div class="tab" [class.active]="tab==='co'" (click)="tab='co'">Saglasnosti</div>
    </div>


    <!-- Overview -->
    <div *ngIf="tab==='ov'" class="grid" style="grid-template-columns:1fr 1fr">
        <div>
            <div class="label">Ime</div>
            <div class="input" style="background:#f8fafc">{{info.firstName}}</div>
        </div>
        <div>
            <div class="label">Prezime</div>
            <div class="input" style="background:#f8fafc">{{info.lastName}}</div>
        </div>
    </div>


    <!-- Scans -->
    <div *ngIf="tab==='sc'" class="mt">
        <div class="row">
            <select class="input" [(ngModel)]="scanType" style="max-width:160px">
                <option>PDF</option>
                <option>Rendgen</option>
                <option>Ultrazvuk</option>
                <option>CT</option>
                <option>Slika</option>
            </select>
            <input type="file" (change)="onScan($event)" accept="application/pdf,image/*" />
            <button class="btn pri" (click)="uploadScan()">Otpremi i šifruj</button>
        </div>
        <table class="table mt" *ngIf="recs.length">
            <thead>
                <tr>
                    <th>Tip</th>
                    <th>Naziv</th>
                    <th>Veličina</th>
                    <th>Popuna</th>
                    <th>Datum</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let r of recs">
                    <td>{{r.recordType}}</td>
                    <td>{{r.originalFileName}}</td>
                    <td>{{r.originalLength}}</td>
                    <td>{{r.paddingLength}}</td>
                    <td>{{r.createdAt | date:'short'}}</td>
                    <td>
                        <button class="btn" (click)="downloadScan(r.id, r.originalFileName)">Preuzmi</button>
                        <button class="btn err" *ngIf="auth.role==='Admin'" (click)="deleteScan(r.id)">Obriši</button>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>


    <!-- Identity Docs -->
    <div *ngIf="tab==='id'" class="mt">
        <div class="row" *ngIf="auth.role==='Admin'">
            <input class="input" [(ngModel)]="idDocType" placeholder="Tip" style="max-width:180px" />
            <input class="input" [(ngModel)]="idDocNumber" placeholder="Broj dokumenta" style="max-width:220px" />
            <input class="input" type="date" [(ngModel)]="idIssue" placeholder="Datum izdavanja" />
            <input class="input" type="date" [(ngModel)]="idExpiry" placeholder="Datum isteka" />
            <input type="file" (change)="onIdFile($event)" accept="application/pdf,image/*" />
            <button class="btn ok" (click)="saveId()">Sačuvaj</button>
        </div>
        <table class="table mt" *ngIf="iddocs.length">
            <thead>
                <tr>
                    <th>Tip</th>
                    <th>Sken</th>
                    <th>Datum</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                <tr *ngFor="let d of iddocs">
                    <td>{{d.docType}}</td>
                    <td>{{d.hasScan ? 'Yes' : 'No'}}</td>
                    <td>{{d.createdAt | date:'short'}}</td>
                    <td><button class="btn" (click)="downloadId(d.id)" [disabled]="!d.hasScan">Preuzmi</button></td>
                </tr>
            </tbody>
        </table>
    </div>


    <!-- Encounters -->
    <div *ngIf="tab==='en'" class="mt">
        <div class="row">
            <input class="input" type="datetime-local" [(ngModel)]="encDate" style="max-width:230px" />
            <input class="input" [(ngModel)]="encNotes" placeholder="Beleške (opciono)" />
            <button class="btn ok" (click)="saveEnc()">Dodaj posetu</button>
        </div>
        <table class="table mt" *ngIf="encs.length">
            <thead>
                <tr>
                    <th>Datum</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>